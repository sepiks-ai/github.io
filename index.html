<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paul Harrald - Interactive CV</title>
  <!-- Added libraries for export functionality -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.js"></script>
  <style>
    :root {
      --primary-color: #1a237e;
      --secondary-color: #283593;
      --accent-color: #42a5f5;
      --light-bg: #f5f5f5;
      --dark-text: #333;
      --light-text: #f5f5f5;
      --border-color: #e0e0e0;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      line-height: 1.6;
      color: var(--dark-text);
      background-color: var(--light-bg);
    }
    
    header {
      background-color: var(--primary-color);
      color: var(--light-text);
      padding: 2rem;
      text-align: center;
      position: relative;
    }
    
    .profile-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .profile-image {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background-color: #fff;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-weight: bold;
      overflow: hidden;
    }
    
    .profile-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    
    .title {
      font-size: 1.2rem;
      opacity: 0.9;
      margin-bottom: 1rem;
    }
    
    .download-container {
      position: relative;
      display: inline-block;
      margin-top: 1rem;
      z-index: 101; /* Higher than the navbar z-index */
    }
    
    .download-btn {
      background-color: var(--accent-color);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 4px;
      text-decoration: none;
      font-weight: bold;
      display: inline-block;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      font-size: 1rem;
    }
    
    .download-btn:hover {
      background-color: #1e88e5;
      transform: translateY(-2px);
    }
    
    .download-options {
      display: none;
      position: absolute;
      background-color: white;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 101; /* Higher than the navbar z-index */
      border-radius: 4px;
      overflow: hidden;
      left: 0;
      margin-top: 5px;
    }
    
    .download-options a {
      color: var(--primary-color);
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      transition: background-color 0.3s;
      cursor: pointer;
    }
    
    .download-options a:hover {
      background-color: var(--light-bg);
    }
    
    .download-container:hover .download-options {
      display: block;
    }
    
    nav {
      background-color: var(--secondary-color);
      position: sticky;
      top: 0;
      z-index: 100; /* Lower than dropdown z-index */
    }
    
    nav ul {
      display: flex;
      justify-content: center;
      list-style: none;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    nav ul li {
      position: relative;
    }
    
    nav ul li a {
      display: block;
      color: var(--light-text);
      text-decoration: none;
      padding: 1rem 1.5rem;
      transition: all 0.3s ease;
    }
    
    nav ul li a:hover {
      background-color: rgba(255,255,255,0.1);
    }
    
    main {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 2rem;
    }
    
    section {
      margin-bottom: 3rem;
      padding: 2rem;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      position: relative;
    }
    
    section h2 {
      color: var(--primary-color);
      margin-bottom: 1.5rem;
      position: relative;
      padding-bottom: 0.5rem;
      display: flex;
      align-items: center;
    }
    
    section h2:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100px;
      height: 3px;
      background-color: var(--accent-color);
    }
    
    .video-button {
      position: absolute;
      right: 2rem;
      top: 2rem;
      background-color: var(--accent-color);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
    }
    
    .video-button:hover {
      background-color: #1e88e5;
      transform: scale(1.1);
    }
    
    .role-video-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      background-color: var(--accent-color);
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 10px;
      margin-left: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .role-video-button:hover {
      background-color: #1e88e5;
      transform: scale(1.1);
    }
    
    .video-sidebar {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
      z-index: 1000;
      transition: right 0.3s ease;
      display: flex;
      flex-direction: column;
    }
    
    .video-sidebar.active {
      right: 0;
    }
    
    .close-video {
      position: absolute;
      top: 15px;
      right: 15px;
      color: white;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
    }
    
    .video-container {
      flex: 1;
      padding: 60px 20px 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .video-placeholder {
      width: 100%;
      height: 225px;
      background-color: #000;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      border-radius: 8px;
    }
    
    .experience-item {
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 1.5rem;
      overflow: hidden;
    }
    
    .job-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      background-color: var(--light-bg);
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    
    .job-header:hover {
      background-color: rgba(66, 165, 245, 0.1);
    }
    
    .company-info {
      flex: 1;
    }
    
    .company {
      font-size: 1.3rem;
      font-weight: bold;
      color: var(--primary-color);
    }
    
    .period {
      color: var(--secondary-color);
      font-weight: bold;
    }
    
    .location {
      color: #666;
      font-style: italic;
    }
    
    .expand-icon {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease;
    }
    
    .expand-icon.active {
      transform: rotate(180deg);
    }
    
    .job-details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease;
      padding: 0 1.5rem;
    }
    
    .job-details.active {
      max-height: 1000px;
      padding: 1.5rem;
    }
    
    .role {
      font-weight: bold;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
    }
    
    ul.responsibilities {
      margin-left: 1.5rem;
      margin-top: 0.5rem;
    }
    
    ul.responsibilities li {
      margin-bottom: 0.5rem;
    }
    
    .publications-list {
      list-style: none;
    }
    
    .publications-list li {
      margin-bottom: 1.5rem;
      position: relative;
      padding-left: 1.5rem;
    }
    
    .publications-list li:before {
      content: 'üìÑ';
      position: absolute;
      left: 0;
      top: 3px;
    }
    
    .external-links {
      display: flex;
      flex-wrap: wrap;
      margin-top: 2rem;
    }
    
    .external-link {
      background-color: var(--light-bg);
      border-radius: 8px;
      padding: 1rem;
      margin-right: 1rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      text-decoration: none;
      color: var(--primary-color);
      transition: all 0.3s ease;
    }
    
    .external-link:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .icon {
      margin-right: 0.5rem;
      font-size: 1.2rem;
    }
    
    footer {
      background-color: var(--primary-color);
      color: var(--light-text);
      text-align: center;
      padding: 2rem;
      margin-top: 3rem;
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0,0,0,0.5);
      z-index: 999;
      display: none;
    }
    
    .modal-overlay.active {
      display: block;
    }
    
    /* Version control indicator */
    .version-control {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background-color: rgba(0,0,0,0.2);
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
    }
    
    /* Substack styles */
    .substack-container {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    
    .article-card {
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .article-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .article-header {
      background-color: var(--light-bg);
      padding: 1.5rem;
      border-bottom: 1px solid var(--border-color);
    }
    
    .article-title {
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
      color: var(--primary-color);
    }
    
    .article-date {
      color: #666;
      font-size: 0.9rem;
    }
    
    .article-excerpt {
      padding: 1.5rem;
      color: var(--dark-text);
    }
    
    .article-link {
      display: inline-block;
      margin-top: 1rem;
      color: var(--accent-color);
      font-weight: bold;
      text-decoration: none;
    }
    
    .article-link:hover {
      text-decoration: underline;
    }
    
    .loading-text {
      text-align: center;
      color: #666;
      padding: 2rem;
    }
    
    .error-text {
      text-align: center;
      color: #e74c3c;
      padding: 2rem;
    }
  </style>
</head>
<body>
  <!-- Section video sidebars -->
  <div id="video-sidebar-profile" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('profile')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Profile Overview Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-experience" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('experience')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Experience Overview Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-education" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('education')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Education Overview Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-publications" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('publications')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Publications Overview Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-visiting" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('visiting')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Visiting Positions Overview Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-substack" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('substack')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Substack Overview Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-references" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('references')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">References Overview Video</div>
    </div>
  </div>
  
  <!-- Role video sidebars -->
  <div id="video-sidebar-sepiks" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('sepiks')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Sepiks.ai Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-wolfram" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('wolfram')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Wolfram Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-curve" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('curve')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Curve Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-creditease" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('creditease')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">CreditEase Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-google" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('google')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Google Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-arrowgrass" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('arrowgrass')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Arrowgrass Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-ucl" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('ucl')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">UCL Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-stan" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('stan')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Standard Chartered Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-florence" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('florence')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">Florence Art Course Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-gecapital" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('gecapital')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">GE Capital Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-sav" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('sav')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">SAV Capital Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-rbs" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('rbs')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">RBS Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-ge" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('ge')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">GE Role Video</div>
    </div>
  </div>
  
  <div id="video-sidebar-umist" class="video-sidebar">
    <button class="close-video" onclick="closeVideoSidebar('umist')">√ó</button>
    <div class="video-container">
      <div class="video-placeholder">UMIST Role Video</div>
    </div>
  </div>
  
  <!-- Modal overlay -->
  <div class="modal-overlay" id="modal-overlay"></div>
  
  <header>
    <div class="version-control">Version 1.6 - March 2025</div>
    <div class="profile-container">
      <div class="profile-image">
        <img src="assets/gitProfilePic.jpeg" alt="Paul Harrald">
      </div>
      <h1>Paul Harrald</h1>
      <p class="title">Executive, Entrepreneur & AI/Blockchain Researcher</p>
      
      <!-- Updated download options with export functionality -->
      <div class="download-container">
        <button class="download-btn">Download CV ‚ñº</button>
        <div class="download-options">
          <a href="#" onclick="generatePDF(); return false;">PDF Format</a>
          <a href="#" onclick="generateWord(); return false;">Word Format</a>
          <a href="#" onclick="openInGoogleDocs(); return false;">Google Docs</a>
        </div>
      </div>
    </div>
  </header>
  
  <nav>
    <ul>
      <li><a href="#profile">Profile</a></li>
      <li><a href="#experience">Experience</a></li>
      <li><a href="#education">Education</a></li>
      <li><a href="#publications">Publications</a></li>
      <li><a href="#visiting">Visiting Positions</a></li>
      <li><a href="#substack">Substack</a></li>
      <li><a href="#references">References</a></li>
    </ul>
  </nav>
  
  <main>
    <section id="profile">
      <button class="video-button" onclick="openVideoSidebar('profile')">‚ñ∂</button>
      <h2>Profile</h2>
      <div class="content">
        <p>Executive and entrepreneur with tenured research level academic skills in AI, blockchain and simulation; 20 years of experience in corporate leadership, 2x ¬£500m++ start up. Business experience includes multiple board level positions with an emphasis on ML, finance, and risk strategy. Senior buy side experience in private equity and hedge funds; management of large teams and potent individual contribution. Founded 2x consumer lending companies both based on advanced use of data (EEA/UK).</p>
      </div>
    </section>
    
    <section id="experience">
      <button class="video-button" onclick="openVideoSidebar('experience')">‚ñ∂</button>
      <h2>Experience</h2>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">Sepiks.ai</div>
            <div class="meta-info">
              <span class="period">Jan 2024 - Present</span> | <span class="location">London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Founder, incubator
            <button class="role-video-button" onclick="openRoleVideoSidebar('sepiks')">‚ñ∂</button>
          </div>
          <p>Incubating and bootstrapping it until a CTO is hired and an Angel round is complete.</p>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">Wolfram Summer School</div>
            <div class="meta-info">
              <span class="period">June 2024 - August 2024</span> | <span class="location">Online</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Researcher
            <button class="role-video-button" onclick="openRoleVideoSidebar('wolfram')">‚ñ∂</button>
          </div>
          <p>Investigating Bohmian quantum computing and evolutionary game simulations.</p>
          <p><a href="https://community.wolfram.com/web/pharrald" target="_blank">View my work</a></p>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">CURVE</div>
            <div class="meta-info">
              <span class="period">Dec 2020 - Present</span> | <span class="location">London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Group CFO, CIO, CEO Curve Credit Ltd; Advisor
            <button class="role-video-button" onclick="openRoleVideoSidebar('curve')">‚ñ∂</button>
          </div>
          <p>A CreditEase portfolio investment. Joined from the fund at Series C to create consumer lending businesses in US, EEA and UK; once done, then CIO and CFO, Board Director.</p>
          <ul class="responsibilities">
            <li>All regulatory liaison for establishment of consumer lending permissions in UK and EEA (as SMF1); secured $1bn senior funding and a BIN-sponsor arrangement in the US. Developed in-app lending product and built out servicing infrastructure.</li>
            <li>As CIO developed a credible and advanced ML/AI agenda and real-time monitoring. Successfully created and managed a risk and compliance function and replaced and managed all executive management in Lithuania.</li>
            <li>As CFO, with CEO led a successful fundraising rounds holding the 2021 Series C valuation while implementing treasury, capital and cash flow management.</li>
            <li>Orchestrated a full turnaround of business model from all-margin negative to all margin positive. Clean NMC PWC audit of all entities, clean audits in the US and EEA.</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">CREDITEASE FINTECH FUND AND FUND OF FUNDS</div>
            <div class="meta-info">
              <span class="period">Nov 2018 - Dec 2020</span> | <span class="location">London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Managing Director, Head of European Investments
            <button class="role-video-button" onclick="openRoleVideoSidebar('creditease')">‚ñ∂</button>
          </div>
          <p>Recruited by a former employee to lead EU/UK investments in fintech for this Chinese fund.</p>
          <ul class="responsibilities">
            <li>Leading origination of UK and European investments for the $500m fund.</li>
            <li>Of the fund's 42 investments 9 became unicorns in this time.</li>
            <li>Sourcing deals, management of deal flow, due diligence and investment structuring.</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">GOOGLE</div>
            <div class="meta-info">
              <span class="period">Dec 2016 - Nov 2018</span> | <span class="location">Hyderabad, Singapore, London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Risk Advisor
            <button class="role-video-button" onclick="openRoleVideoSidebar('google')">‚ñ∂</button>
          </div>
          <p>Recruited by former STAN regional CEO to act as Credit and Risk Advisor to the Next Billion Users initiatives focused on financial products.</p>
          <ul class="responsibilities">
            <li>Technical consulting on uses of machine learning and AI in financial product provision</li>
            <li>Support Capital G on (African) M&A investment opportunities.</li>
            <li>Evaluation of provision new financial products</li>
            <li>Evaluation of alternatives Google data to support real time decisioning</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">ARROWGRASS CAPITAL PARTNERS</div>
            <div class="meta-info">
              <span class="period">Oct 2015 - Nov 2016</span> | <span class="location">London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
       <div class="job-details">
          <div class="role">
            Head of Alternative Lending
            <button class="role-video-button" onclick="openRoleVideoSidebar('arrowgrass')">‚ñ∂</button>
          </div>
          <p>Recruited into this $5bn hedge fund after a consulting contract designing risk systems.</p>
          <ul class="responsibilities">
            <li>Evaluation and structuring debt and equity transactions in fintech lending</li>
            <li>Design and implementation of a risk measurement framework for alternative lending</li>
            <li>Multiple fintech investments side-pocketed and listed successfully.</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">UNIVERSITY COLLEGE LONDON</div>
            <div class="meta-info">
              <span class="period">Sep 2013 - Nov 2020</span> | <span class="location">London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            UCL visiting Professor in Computing Science
            <button class="role-video-button" onclick="openRoleVideoSidebar('ucl')">‚ñ∂</button>
          </div>
          <p>Supervision of students in PhD research, <em>ad hoc</em> teaching and research in blockchain engineering, AI/ML and economic (banking) systems simulation. Advisor to the Alan Turing Institute on AI/ML in industry.</p>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">STANDARD CHARTERED PLC</div>
            <div class="meta-info">
              <span class="period">Sep 2007 - Aug 2014</span> | <span class="location">Singapore and London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Managing Director, Global Head Portfolio Risk, Group Head Risk Strategy, Head of Quantitative Analytics
            <button class="role-video-button" onclick="openRoleVideoSidebar('stan')">‚ñ∂</button>
          </div>
          <p>Sequence of increasingly responsible positions ultimately a member of bank's Executive Management Team</p>
          <ul class="responsibilities">
            <li>Created and set Group risk appetite across all risk types, led active credit portfolio trading and issuance, set and managed ALM and liquidity risk limits. Led scenario analysis and stress testing, leading to ICAAP, ILAA.</li>
            <li>Led UK PRA interaction Liaised with, advised and influenced central banks, regulatory bodies and supranationals in all areas of prudential regulation.</li>
            <li>Voting member of the Capital Management and Group Credit Committees <em>inter alia</em>.</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">Art Course in Florence</div>
            <div class="meta-info">
              <span class="period">Nov 2006 - Sep 2007</span> | <span class="location">Florence, Italy</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Sabbatical
            <button class="role-video-button" onclick="openRoleVideoSidebar('florence')">‚ñ∂</button>
          </div>
          <p>Sabbatical period studying fine art in Florence, Italy.</p>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">GE CAPITAL</div>
            <div class="meta-info">
              <span class="period">Jul 2004 - Oct 2006</span> | <span class="location">Stamford CT</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Vice President, Analytics and Risk Strategy
            <button class="role-video-button" onclick="openRoleVideoSidebar('gecapital')">‚ñ∂</button>
          </div>
          <p>After NewDay exit, invited back to GE.</p>
          <ul class="responsibilities">
            <li>Corporate VP role based in GE Capital headquarters in Stamford CT, with global responsibility for risk strategy and quantitative analytics.</li>
            <li>Developed global risk appetite and Edison-award winning stress testing framework used during mortgage crisis.</li>
            <li>Due diligence in acquisitions of UK/EEA banks.</li>
            <li>Liaison with GE R&D with introduction of novel ML optimisation techniques</li>
            <li>Deal support for substantial structured finance issuance.</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">SAV CAPITAL, SAV CREDIT, NEWDAY</div>
            <div class="meta-info">
              <span class="period">Feb 2000 - Apr 2004</span> | <span class="location">London</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Chief Information Officer and Director of Analytics
            <button class="role-video-button" onclick="openRoleVideoSidebar('sav')">‚ñ∂</button>
          </div>
          <ul class="responsibilities">
            <li>Day 1 figure in the founding team of this successful alternative finance consumer lending start-up, through first equity raising, establishment of key commercial contracts and debt raising, on to operational success, profitability and exit.</li>
            <li>Company sold for $740m to V√§rde.</li>
            <li>A crucial step was massively to outperform traditional credit scoring, The individual score I built was eventually sold standalone for ¬£1m.</li>
            <li>Other responsibilities included IT and data infrastructure build; design of automated marketing campaigns; maintenance of financial models</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">ROYAL BANK OF SCOTLAND PLC</div>
            <div class="meta-info">
              <span class="period">Jan 1998 - Feb 2000</span> | <span class="location">Edinburgh</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Director, Business Analysis, then Board of Retail Direct
            <button class="role-video-button" onclick="openRoleVideoSidebar('rbs')">‚ñ∂</button>
          </div>
          <p>Initially head-hunted into leadership of a credit card joint venture with Advanta, then, after the merge with NatWest, elevated to Board of Retail Direct and executive management team of NatWest Streamline and other businesses.</p>
          <ul class="responsibilities">
            <li>Functionally responsible for IT across direct retail lending and merchant acquiring (50% of UK transactions were acquired by this business) and business analysis.</li>
            <li>Led initial due diligence on retail lending and upon NatWest merger, created merged business units and backend systems.</li>
            <li>Led renegotiation of largest strategic supplier contracts, developed European strategy.</li>
            <li>Developed credible ML program.</li>
          </ul>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">GE CAPITAL</div>
            <div class="meta-info">
              <span class="period">Jun 1996 - Jan 1998</span> | <span class="location">Leeds and Paris</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Analyst, Senior Analyst, Senior Manager, Director
            <button class="role-video-button" onclick="openRoleVideoSidebar('ge')">‚ñ∂</button>
          </div>
          <p>Recruited out of University role to help create a Global Modelling Team in a sequence of more senior roles in data science.</p>
        </div>
      </div>
      
      <div class="experience-item">
        <div class="job-header" onclick="toggleJobDetails(this)">
          <div class="company-info">
            <div class="company">UNIVERSITY OF MANCHESTER, INSTITUTE OF SCIENCE AND TECHNOLOGY</div>
            <div class="meta-info">
              <span class="period">Jun 1994 - Jun 1996</span> | <span class="location">Manchester</span>
            </div>
          </div>
          <div class="expand-icon">‚ñº</div>
        </div>
        <div class="job-details">
          <div class="role">
            Lecturer with Tenure in Economics
            <button class="role-video-button" onclick="openRoleVideoSidebar('umist')">‚ñ∂</button>
          </div>
          <p>Tenured after 6 months of joining the University, with a lectureship in economics, quantitative methods and game theory, included visiting positions in Max Planck Institute, UCSD and Helsinki Business School. Developed and became Director of the MSc in Business Economics</p>
        </div>
      </div>
      
    </section>
    
    <section id="education">
      <button class="video-button" onclick="openVideoSidebar('education')">‚ñ∂</button>
      <h2>Education</h2>
      <div class="content">
        <p>BA (Hons), and MA, PhD, Economics at Simon Fraser University supported by a Commonwealth Scholarship, the Sir Peter Allen Travelling Fellowship and grants from the Social Sciences and Humanities research Council of Canada.</p>
      </div>
    </section>
    
    <section id="publications">
      <button class="video-button" onclick="openVideoSidebar('publications')">‚ñ∂</button>
      <h2>Selected Publications</h2>
      <ul class="publications-list">
        <li>Opeoluwa, B., P. Harrald and F. Medda, "Understanding the consequences of diversification on financial stability" <em>Journal of Economic Interaction and Coordination</em>, January 2018.</li>
        <li>Opeoluwa, B., P. Harrald <em>et al</em> "The effect of heterogeneity on financial contagion due to overlapping portfolios" <em>Advances in Complex Systems</em>, 19 (8), December 2016.</li>
        <li>Kan, Y.Y., P. Harrald <em>et al</em>. "Transfer risk under Basel Pillar 1," <em>Journal of Credit Risk</em>, June 2011.</li>
        <li>Gomme, P and P. Harrald "Applying evolutionary programming to selected set partitioning problems," <em>Fuzzy Sets and Systems</em>, June 1998.</li>
        <li>Harrald, P. and M. Kamstra "Evolving neural networks to combine financial forecasts," <em>IEEE Transactions on Evolutionary Programming</em>, June 1997.</li>
        <li>Fogel, D. and P. Harrald "Evolving continuous behaviors in the iterated prisoner's dilemma", <em>Biosystems</em>, June 1996.</li>
      </ul>
    </section>
    
    <section id="visiting">
      <button class="video-button" onclick="openVideoSidebar('visiting')">‚ñ∂</button>
      <h2>Visiting Positions</h2>
      <ul>
        <li><strong>University College London</strong>, honorary visiting Professor in Computing Science</li>
        <li><strong>Max Planck Institute</strong>, Jena, Visiting Scholar, Institute for Evolutionary Economics</li>
        <li><strong>Helsinki School of Economics and Business Administration</strong>, visiting Lecturer</li>
        <li><strong>Wilfrid Laurier University Department of Economics</strong>, visiting Scholar</li>
        <li><strong>Edinburgh University</strong>, <strong>Artificial Intelligence Applications Institute</strong>, visiting Scholar</li>
        <li><strong>Canadian Institute for Advanced Research</strong>, assisting Prof Richard Lipsey in research into innovation and economic growth</li>
        <li><strong>Oxford University</strong>, Sa√Ød Business School, lectures in fintech</li>
      </ul>
    </section>
    
    <!-- Substack section -->
    <section id="substack">
      <button class="video-button" onclick="openVideoSidebar('substack')">‚ñ∂</button>
      <h2>Substack Articles</h2>
      <div id="substack-articles" class="substack-container">
        <p class="loading-text">Loading articles...</p>
      </div>
    </section>
    
    <section id="references">
      <button class="video-button" onclick="openVideoSidebar('references')">‚ñ∂</button>
      <h2>References</h2>
      <p>FTSE 100 Board level references available. All my previous managers since 2000 are available for reference.</p>
      
      <div class="external-links">
        <h3>External Resources</h3>
        <a href="https://community.wolfram.com/web/pharrald" class="external-link" target="_blank">
          <span class="icon">üîó</span> Wolfram Community Profile
        </a>
        <a href="http://www.sepiks.ai" class="external-link" target="_blank">
          <span class="icon">üè¢</span> Sepiks.ai
        </a>
        <a href="https://www.curve.com/en-gb/" class="external-link" target="_blank">
          <span class="icon">üíº</span> CURVE
        </a>
        <a href="https://github.com/yourprofile" class="external-link" target="_blank">
          <span class="icon">üíª</span> GitHub Profile
        </a>
        <a href="https://linkedin.com/in/yourprofile" class="external-link" target="_blank">
          <span class="icon">üëî</span> LinkedIn Profile
        </a>
      </div>
    </section>
  </main>
  
  <footer>
    <p>&copy; 2025 Paul Harrald. All rights reserved.</p>
  </footer>

  <script>
    // Function to toggle job details
    function toggleJobDetails(element) {
      const details = element.nextElementSibling;
      const expandIcon = element.querySelector('.expand-icon');
      
      if (details.classList.contains('active')) {
        details.classList.remove('active');
        expandIcon.classList.remove('active');
      } else {
        details.classList.add('active');
        expandIcon.classList.add('active');
      }
    }
    
    // Function to open video sidebar for sections
    function openVideoSidebar(section) {
      document.getElementById(`video-sidebar-${section}`).classList.add('active');
      document.getElementById('modal-overlay').classList.add('active');
    }
    
    // Function to open video sidebar for individual roles
    function openRoleVideoSidebar(roleId) {
      document.getElementById(`video-sidebar-${roleId}`).classList.add('active');
      document.getElementById('modal-overlay').classList.add('active');
      // Prevent the click from toggling the job details
      event.stopPropagation();
    }
    
    // Function to close video sidebar
    function closeVideoSidebar(section) {
      document.getElementById(`video-sidebar-${section}`).classList.remove('active');
      document.getElementById('modal-overlay').classList.remove('active');
    }
    
    // Close sidebar when clicking on overlay
    document.getElementById('modal-overlay').addEventListener('click', function() {
      document.querySelectorAll('.video-sidebar').forEach(sidebar => {
        sidebar.classList.remove('active');
      });
      this.classList.remove('active');
    });
    
    // Function to fetch and display Substack articles
    async function fetchSubstackArticles() {
      const substackURL = 'https://paulharrald.substack.com'; // Updated with correct Substack URL
      const corsProxy = 'https://api.allorigins.win/raw?url=';
      const rssURL = `${corsProxy}${encodeURIComponent(substackURL + '/feed')}`;
      
      const substackContainer = document.getElementById('substack-articles');
      
      try {
        const response = await fetch(rssURL);
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        
        const data = await response.text();
        const parser = new DOMParser();
        const xml = parser.parseFromString(data, 'application/xml');
        const items = xml.querySelectorAll('item');
        
        if (items.length === 0) {
          substackContainer.innerHTML = '<p class="error-text">No articles found</p>';
          return;
        }
        
        substackContainer.innerHTML = '';
        
        // Display the latest 5 articles
        const articlesToDisplay = Math.min(items.length, 5);
        
        for (let i = 0; i < articlesToDisplay; i++) {
          const item = items[i];
          const title = item.querySelector('title').textContent;
          const link = item.querySelector('link').textContent;
          const pubDate = new Date(item.querySelector('pubDate').textContent);
          const description = item.querySelector('description').textContent;
          
          // Format date
          const formattedDate = pubDate.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          });
          
          // Extract excerpt - remove HTML tags and limit length
          const tempDiv = document.createElement('div');
          tempDiv.innerHTML = description;
          const excerpt = tempDiv.textContent.trim().substring(0, 200) + '...';
          
          const articleCard = document.createElement('div');
          articleCard.className = 'article-card';
          articleCard.innerHTML = `
            <div class="article-header">
              <h3 class="article-title">${title}</h3>
              <div class="article-date">${formattedDate}</div>
            </div>
            <div class="article-excerpt">
              <p>${excerpt}</p>
              <a href="${link}" target="_blank" class="article-link">Read More</a>
            </div>
          `;
          
          substackContainer.appendChild(articleCard);
        }
        
      } catch (error) {
        console.error('Error fetching Substack articles:', error);
        substackContainer.innerHTML = `
          <p class="error-text">
            Could not load Substack articles. 
            <a href="${substackURL}" target="_blank">View on Substack</a>
          </p>
        `;
      }
    }
    
    // Function to extract CV content from the current page
    function generateCVContent() {
      // Extract data from your current CV
      const name = document.querySelector('h1').textContent;
      const title = document.querySelector('.title').textContent;
      
      // Get profile text
      const profile = document.querySelector('#profile .content').textContent.trim();
      
      // Get experience items
      const experienceItems = [];
      document.querySelectorAll('.experience-item').forEach(item => {
        const company = item.querySelector('.company').textContent;
        const period = item.querySelector('.period').textContent;
        const location = item.querySelector('.location').textContent;
        
        // Role text may have the video button, need to clean it
        let role = '';
        const roleElement = item.querySelector('.role');
        if (roleElement) {
          // Clone the element to avoid modifying the original
          const roleClone = roleElement.cloneNode(true);
          // Remove any button elements
          const buttons = roleClone.querySelectorAll('button');
          buttons.forEach(button => button.remove());
          role = roleClone.textContent.trim();
        }
        
        // Get responsibilities
        const responsibilities = [];
        const responsibilitiesList = item.querySelector('ul.responsibilities');
        if (responsibilitiesList) {
          responsibilitiesList.querySelectorAll('li').forEach(li => {
            responsibilities.push(li.textContent.trim());
          });
        }
        
        // Get description paragraph
        let description = '';
        const descParagraph = item.querySelector('.job-details > p');
        if (descParagraph) {
          description = descParagraph.textContent.trim();
        }
        
        experienceItems.push({
          company,
          period,
          location,
          role,
          description,
          responsibilities
        });
      });
      
      // Get education
      const education = document.querySelector('#education .content').textContent.trim();
      
      // Get publications
      const publications = [];
      document.querySelectorAll('.publications-list li').forEach(item => {
        publications.push(item.textContent.trim());
      });
      
      // Get visiting positions
      const visitingPositions = [];
      document.querySelectorAll('#visiting ul li').forEach(item => {
        visitingPositions.push(item.textContent.trim());
      });
      
      return {
        name,
        title,
        profile,
        experience: experienceItems,
        education,
        publications,
        visitingPositions
      };
    }
    
    // Function to generate and download PDF
    function generatePDF() {
      // Create a clean, print-friendly version of the CV
      const cvData = generateCVContent();
      
      // Create a new element for the PDF content
      const pdfContent = document.createElement('div');
      pdfContent.className = 'pdf-export';
      pdfContent.style.width = '210mm';  // A4 width
      pdfContent.style.padding = '10mm';
      pdfContent.style.fontFamily = 'Arial, sans-serif';
      pdfContent.style.color = '#333';
      
      // Add header with name and title
      const header = document.createElement('div');
      header.innerHTML = `
        <h1 style="font-size: 28px; color: #1a237e; margin-bottom: 5px;">${cvData.name}</h1>
        <p style="font-size: 18px; color: #283593; margin-top: 0;">${cvData.title}</p>
        <hr style="border: 1px solid #42a5f5; margin: 15px 0 20px 0;">
      `;
      pdfContent.appendChild(header);
      
      // Add profile section
      const profile = document.createElement('div');
      profile.innerHTML = `
        <h2 style="font-size: 18px; color: #1a237e; margin-bottom: 10px;">PROFILE</h2>
        <p style="margin-bottom: 20px;">${cvData.profile}</p>
      `;
      pdfContent.appendChild(profile);
      
      // Add experience section
      const experience = document.createElement('div');
      experience.innerHTML = `<h2 style="font-size: 18px; color: #1a237e; margin-bottom: 15px;">EXPERIENCE</h2>`;
      
      cvData.experience.forEach(item => {
        const expItem = document.createElement('div');
        expItem.style.marginBottom = '20px';
        
        expItem.innerHTML = `
          <h3 style="margin-bottom: 5px; color: #283593;">${item.company}</h3>
          <p style="margin-top: 0; margin-bottom: 8px; font-style: italic;">
            <strong>${item.role}</strong> | ${item.period} | ${item.location}
          </p>
        `;
        
        if (item.description) {
          const desc = document.createElement('p');
          desc.style.marginBottom = '8px';
          desc.textContent = item.description;
          expItem.appendChild(desc);
        }
        
        if (item.responsibilities && item.responsibilities.length > 0) {
          const ul = document.createElement('ul');
          ul.style.marginTop = '5px';
          ul.style.paddingLeft = '20px';
          
          item.responsibilities.forEach(resp => {
            const li = document.createElement('li');
            li.style.marginBottom = '3px';
            li.textContent = resp;
            ul.appendChild(li);
          });
          
          expItem.appendChild(ul);
        }
        
        experience.appendChild(expItem);
      });
      
      pdfContent.appendChild(experience);
      
      // Add education section
      const educationSection = document.createElement('div');
      educationSection.innerHTML = `
        <h2 style="font-size: 18px; color: #1a237e; margin-top: 25px; margin-bottom: 10px;">EDUCATION</h2>
        <p>${cvData.education}</p>
      `;
      pdfContent.appendChild(educationSection);
      
      // Add publications section
      if (cvData.publications.length > 0) {
        const publicationsSection = document.createElement('div');
        publicationsSection.innerHTML = `
          <h2 style="font-size: 18px; color: #1a237e; margin-top: 25px; margin-bottom: 10px;">SELECTED PUBLICATIONS</h2>
        `;
        
        const pubList = document.createElement('ul');
        pubList.style.paddingLeft = '20px';
        
        cvData.publications.forEach(pub => {
          const li = document.createElement('li');
          li.style.marginBottom = '8px';
          li.innerHTML = pub;
          pubList.appendChild(li);
        });
        
        publicationsSection.appendChild(pubList);
        pdfContent.appendChild(publicationsSection);
      }
      
      // Add visiting positions section
      if (cvData.visitingPositions.length > 0) {
        const visitingSection = document.createElement('div');
        visitingSection.innerHTML = `
          <h2 style="font-size: 18px; color: #1a237e; margin-top: 25px; margin-bottom: 10px;">VISITING POSITIONS</h2>
        `;
        
        const visitingList = document.createElement('ul');
        visitingList.style.paddingLeft = '20px';
        
        cvData.visitingPositions.forEach(pos => {
          const li = document.createElement('li');
          li.style.marginBottom = '5px';
          li.innerHTML = pos;
          visitingList.appendChild(li);
        });
        
        visitingSection.appendChild(visitingList);
        pdfContent.appendChild(visitingSection);
      }
      
      // Add footer
      const footer = document.createElement('div');
      footer.style.marginTop = '30px';
      footer.style.textAlign = 'center';
      footer.style.fontSize = '12px';
      footer.style.color = '#666';
      footer.innerHTML = `Generated on ${new Date().toLocaleDateString()}`;
      pdfContent.appendChild(footer);
      
      // Temporarily add to document (hidden), convert to PDF, then remove
      pdfContent.style.position = 'absolute';
      pdfContent.style.left = '-9999px';
      document.body.appendChild(pdfContent);
      
      const opt = {
        margin: [10, 10, 10, 10],
        filename: 'paul-harrald-cv.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      
      // Generate PDF and download
      html2pdf().set(opt).from(pdfContent).save().then(() => {
        document.body.removeChild(pdfContent);
      });
    }
    
    // Function to generate and download Word document
    function generateWord() {
      const cvData = generateCVContent();
      
      // Ensure docx is available
      if (typeof docx === 'undefined') {
        alert('Error: docx library not loaded. Please try again later.');
        return;
      }
      
      // Create a new Document
      const doc = new docx.Document({
        sections: [{
          properties: {},
          children: [
            // Header with name and title
            new docx.Paragraph({
              text: cvData.name,
              heading: docx.HeadingLevel.HEADING_1,
              thematicBreak: true,
              spacing: { after: 200 }
            }),
            new docx.Paragraph({
              text: cvData.title,
              spacing: { after: 400 }
            }),
            
            // Profile section
            new docx.Paragraph({
              text: "PROFILE",
              heading: docx.HeadingLevel.HEADING_2,
              spacing: { before: 400, after: 200 }
            }),
            new docx.Paragraph({
              text: cvData.profile,
              spacing: { after: 400 }
            })
          ]
        }]
      });
      
      // Add experience section
      doc.addSection({
        properties: {},
        children: [
          new docx.Paragraph({
            text: "EXPERIENCE",
            heading: docx.HeadingLevel.HEADING_2,
            spacing: { before: 400, after: 200 }
          }),
          
          // Add each experience item
          ...cvData.experience.flatMap(exp => {
            const paragraphs = [
              new docx.Paragraph({
                text: exp.company,
                heading: docx.HeadingLevel.HEADING_3,
                spacing: { before: 300, after: 100 }
              }),
              new docx.Paragraph({
                children: [
                  new docx.TextRun({
                    text: `${exp.role} | ${exp.period} | ${exp.location}`,
                    italics: true
                  })
                ],
                spacing: { after: 200 }
              })
            ];
            
            // Add description if available
            if (exp.description) {
              paragraphs.push(
                new docx.Paragraph({
                  text: exp.description,
                  spacing: { after: 200 }
                })
              );
            }
            
            // Add responsibilities as bullet points
            if (exp.responsibilities && exp.responsibilities.length > 0) {
              exp.responsibilities.forEach(resp => {
                paragraphs.push(
                  new docx.Paragraph({text: resp,
                    bullet: { level: 0 },
                    spacing: { after: 100 }
                  })
                );
              });
            }
            
            return paragraphs;
          })
        ]
      });
      
      // Add education section
      doc.addSection({
        properties: {},
        children: [
          new docx.Paragraph({
            text: "EDUCATION",
            heading: docx.HeadingLevel.HEADING_2,
            spacing: { before: 400, after: 200 }
          }),
          new docx.Paragraph({
            text: cvData.education,
            spacing: { after: 400 }
          })
        ]
      });
      
      // Add publications section if available
      if (cvData.publications.length > 0) {
        doc.addSection({
          properties: {},
          children: [
            new docx.Paragraph({
              text: "SELECTED PUBLICATIONS",
              heading: docx.HeadingLevel.HEADING_2,
              spacing: { before: 400, after: 200 }
            }),
            ...cvData.publications.map(pub => 
              new docx.Paragraph({
                text: pub,
                bullet: { level: 0 },
                spacing: { after: 200 }
              })
            )
          ]
        });
      }
      
      // Add visiting positions section if available
      if (cvData.visitingPositions.length > 0) {
        doc.addSection({
          properties: {},
          children: [
            new docx.Paragraph({
              text: "VISITING POSITIONS",
              heading: docx.HeadingLevel.HEADING_2,
              spacing: { before: 400, after: 200 }
            }),
            ...cvData.visitingPositions.map(pos => 
              new docx.Paragraph({
                text: pos,
                bullet: { level: 0 },
                spacing: { after: 100 }
              })
            )
          ]
        });
      }
      
      // Generate and download the document
      docx.Packer.toBlob(doc).then(blob => {
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'paul-harrald-cv.docx';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      });
    }
    
    // Function to open document in Google Docs (simplified version)
    function openInGoogleDocs() {
      // Since Google Docs requires OAuth and API setup, for now we'll use a simplified approach
      // This will open a Google Doc template and let the user copy-paste
      alert('To use Google Docs, we\'ll open a new document where you can paste your CV content.');
      
      // Open a new Google Doc
      window.open('https://docs.new', '_blank');
      
      // Future enhancement: Implement proper Google Docs API integration
    }
    
    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      // Open first job by default for better UX
      const firstJob = document.querySelector('.experience-item:first-child .job-header');
      if (firstJob) {
        toggleJobDetails(firstJob);
      }
      
      // Fetch Substack articles
      fetchSubstackArticles();
    });
  </script>
</body>
</html>